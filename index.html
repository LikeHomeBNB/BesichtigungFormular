<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkliste Immobilienbesichtigung - Erweitert</title>
    <style>
        @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .page-break { page-break-before: always; }
        }
        
        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            line-height: 1.4;
            margin: 20px;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #2c5aa0;
            margin-bottom: 30px;
            font-size: 18px;
        }
        
        .section {
            margin-bottom: 25px;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
        }
        
        .section-title {
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .rating-select, .room-type-select {
            padding: 3px 8px;
            border: 1px solid #333;
            border-radius: 3px;
            font-size: 12px;
            background: white;
            width: 120px;
        }
        
        .rating-scale-select {
            padding: 3px 8px;
            border: 1px solid #333;
            border-radius: 3px;
            font-size: 11px;
            background: white;
            width: 100%;
        }
        
        .yes-no-select {
            padding: 3px 8px;
            border: 1px solid #333;
            border-radius: 3px;
            font-size: 12px;
            background: white;
            width: 80px;
        }
        
        .form-row {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .form-row label {
            display: inline-block;
            width: 200px;
            margin-right: 10px;
        }
        
        input[type="text"], input[type="date"], input[type="time"], input[type="number"], textarea {
            border: none;
            border-bottom: 1px solid #333;
            padding: 2px 5px;
            font-size: 12px;
            background: transparent;
            flex: 1;
            min-width: 150px;
        }
        
        input[type="number"] {
            width: 80px;
            flex: none;
        }
        
        input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.2);
        }
        
        textarea {
            border: 1px solid #333;
            min-height: 60px;
            width: 100%;
            resize: vertical;
        }
        
        .disabled-field {
            background-color: #f0f0f0;
            color: #666;
            cursor: not-allowed;
        }
        
        .disabled-field::placeholder {
            color: #999;
        }
        
        .checkbox-group {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }
        
        .unit-block {
            border: 2px solid #2c5aa0;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        
        .unit-title {
            font-weight: bold;
            color: #2c5aa0;
            font-size: 16px;
            margin-bottom: 15px;
            text-decoration: underline;
        }
        
        .room-block {
            border: 1px solid #ccc;
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 5px;
            background-color: #fafafa;
        }
        
        .room-title {
            font-weight: bold;
            color: #444;
            margin-bottom: 10px;
            font-size: 13px;
        }
        
        .subsection {
            margin-bottom: 15px;
        }
        
        .subsection-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #555;
        }
        
        .room-config-panel {
            background: #e8f4fd;
            border: 1px solid #2c5aa0;
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        .room-config-title {
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 8px;
            font-size: 13px;
        }
        
        .room-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            table-layout: fixed;
        }
        
        .room-table th, .room-table td {
            border: 1px solid #333;
            padding: 8px;
            text-align: left;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .room-table th:first-child, .room-table td:first-child {
            width: 25%;
        }
        
        .room-table th:nth-child(2), .room-table td:nth-child(2) {
            width: 37.5%;
        }
        
        .room-table th:nth-child(3), .room-table td:nth-child(3) {
            width: 37.5%;
        }
        
        .room-table th {
            background-color: #f0f0f0;
            font-weight: bold;
            font-size: 11px;
        }
        
        .room-table input {
            border: none;
            width: 100%;
            background: transparent;
            font-size: 11px;
            padding: 2px;
            box-sizing: border-box;
        }
        
        .rating-help {
            font-size: 10px;
            color: #666;
            margin-top: 5px;
            line-height: 1.3;
        }
        
        .specific-criteria {
            background: #f9f9f9;
            border: 1px solid #ddd;
            padding: 8px;
            border-radius: 3px;
            margin-top: 8px;
            font-size: 11px;
        }
        
        .specific-criteria-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }
        
        .summary-section {
            background: #f0f8ff;
            border: 2px solid #2c5aa0;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .summary-title {
            font-weight: bold;
            color: #2c5aa0;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        .summary-item {
            border-bottom: 1px solid #ccc;
            padding: 8px 0;
        }
        
        .summary-room-name {
            font-weight: bold;
            color: #444;
        }
        
        .summary-rating {
            color: #2c5aa0;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .room-table {
                font-size: 10px;
            }
            
            .room-table th, .room-table td {
                padding: 4px;
            }
            
            .room-table input {
                font-size: 10px;
                padding: 1px;
            }
            
            .form-row {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .form-row label {
                width: auto;
                margin-bottom: 5px;
            }
        }
        
        .control-panel {
            background: #e8f2ff;
            border: 2px solid #2c5aa0;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        
        .generate-button, .add-room-button, .remove-room-button {
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .remove-room-button {
            background: #d9534f;
            margin-left: 5px;
        }
        
        .generate-button:hover {
            background: #1e3d6f;
        }
        
        .add-room-button:hover {
            background: #1e3d6f;
        }
        
        .remove-room-button:hover {
            background: #c9302c;
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .print-button:hover {
            background: #1e3d6f;
        }
        
        #einheiten-container {
            margin-top: 20px;
        }
        
        .neuwo-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 8px;
            border-radius: 3px;
            font-size: 11px;
            color: #856404;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <button class="print-button no-print" onclick="window.print()">üìÑ Als PDF drucken</button>
    
    <div class="container">
        <h1>üìã Checkliste Immobilienbesichtigung (Erweitert mit Renovierungsbedarfs-Bewertung)</h1>
        
        <!-- Sektion 1: Allgemeine Objektdaten -->
        <div class="section">
            <div class="section-title">1) Allgemeine Objektdaten</div>
            <div class="form-row">
                <label>Adresse:</label>
                <input type="text" name="adresse">
            </div>
            <div class="form-row">
                <label>Datum:</label>
                <input type="date" name="datum" style="width: 150px;">
            </div>
            <div class="form-row">
                <label>Wer besichtigt?</label>
                <input type="text" name="besichtiger">
            </div>
            <div class="form-row">
                <label>Anzahl Etagen / Wohnungen:</label>
                <input type="text" name="etagen_wohnungen">
            </div>
            <div class="form-row">
                <label>Zweck:</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="zweck_kauf"> Kauf</label>
                    <label><input type="checkbox" name="zweck_miete"> Miete</label>
                </div>
            </div>
        </div>
        
        <!-- Sektion 2: Fragen an den Verk√§ufer -->
        <div class="section">
            <div class="section-title">2) Fragen an den Verk√§ufer</div>
            <div class="form-row">
                <label>1. Warum wird verkauft / vermietet?</label>
                <input type="text" name="grund_verkauf">
            </div>
            <div class="form-row">
                <label>2. Was ist dem Verk√§ufer wichtig?</label>
                <input type="text" name="wichtig_verkaeufer">
            </div>
            <div class="form-row">
                <label>3. Gibt es bekannte M√§ngel? (optional)</label>
                <input type="text" name="bekannte_maengel">
            </div>
            <div class="form-row">
                <label>4. (Nur bei WEG) Sind gr√∂√üere Ma√ünahmen am Gemeinschaftseigentum geplant?</label>
                <input type="text" name="weg_massnahmen">
            </div>
            <div style="margin-top: 15px;">
                <label style="font-weight: bold;">Anmerkungen:</label>
                <textarea name="anmerkungen_verkaeufer" style="margin-top: 5px;"></textarea>
            </div>
        </div>
        
        <!-- Sektion 3: Basis-Check -->
        <div class="section">
            <div class="section-title">3) Basis-Check (immer ausf√ºllen)</div>
            <div class="form-row">
                <label>1. Lage der Stra√üe:</label>
                <select class="rating-select" name="lage_strasse">
                    <option value="">-- Ausw√§hlen --</option>
                    <option value="sehr_gut">sehr gut</option>
                    <option value="gut">gut</option>
                    <option value="normal">normal</option>
                    <option value="schlecht">schlecht</option>
                    <option value="sehr_schlecht">sehr schlecht</option>
                </select>
            </div>
            <div class="form-row">
                <label>2. Nachbarschaft / Umfeld:</label>
                <select class="rating-select" name="nachbarschaft">
                    <option value="">-- Ausw√§hlen --</option>
                    <option value="sehr_gut">sehr gut</option>
                    <option value="gut">gut</option>
                    <option value="normal">normal</option>
                    <option value="schlecht">schlecht</option>
                    <option value="sehr_schlecht">sehr schlecht</option>
                </select>
            </div>
            <div class="form-row">
                <label>3. Hausflur / Eingangsbereich:</label>
                <select class="rating-select" name="hausflur">
                    <option value="">-- Ausw√§hlen --</option>
                    <option value="sehr_gut">sehr gut</option>
                    <option value="gut">gut</option>
                    <option value="normal">normal</option>
                    <option value="schlecht">schlecht</option>
                    <option value="sehr_schlecht">sehr schlecht</option>
                </select>
            </div>
            <div class="form-row">
                <label>4. Keller / Gemeinschaftsr√§ume:</label>
                <select class="rating-select" name="keller">
                    <option value="">-- Ausw√§hlen --</option>
                    <option value="sehr_gut">sehr gut</option>
                    <option value="gut">gut</option>
                    <option value="normal">normal</option>
                    <option value="schlecht">schlecht</option>
                    <option value="sehr_schlecht">sehr schlecht</option>
                </select>
            </div>
            <div class="form-row">
                <label>5. Grundriss passend:</label>
                <select class="yes-no-select" name="grundriss_passend">
                    <option value="">-- Ausw√§hlen --</option>
                    <option value="ja">Ja</option>
                    <option value="nein">Nein</option>
                </select>
            </div>
            <div class="form-row">
                <label>6. Zimmeraufteilung nutzbar:</label>
                <select class="yes-no-select" name="zimmeraufteilung">
                    <option value="">-- Ausw√§hlen --</option>
                    <option value="ja">Ja</option>
                    <option value="nein">Nein</option>
                </select>
            </div>
            <div class="form-row">
                <label>7. Fenster & T√ºren Zustand:</label>
                <select class="rating-select" name="fenster_tueren">
                    <option value="">-- Ausw√§hlen --</option>
                    <option value="sehr_gut">sehr gut</option>
                    <option value="gut">gut</option>
                    <option value="normal">normal</option>
                    <option value="schlecht">schlecht</option>
                    <option value="sehr_schlecht">sehr schlecht</option>
                </select>
            </div>
            <div class="form-row">
                <label>8. Option Grundriss-Optimierung:</label>
                <select class="yes-no-select" name="grundriss_optimierung">
                    <option value="">-- Ausw√§hlen --</option>
                    <option value="ja">Ja</option>
                    <option value="nein">Nein</option>
                </select>
            </div>
            <div class="form-row">
                <label>9. Stellpl√§tze (Anzahl):</label>
                <input type="text" name="stellplaetze">
            </div>
            <div style="margin-top: 15px;">
                <label style="font-weight: bold;">Beschreibung (zum Beispiel Art):</label>
                <textarea name="beschreibung_stellplaetze" style="margin-top: 5px;"></textarea>
            </div>
            <div style="margin-top: 15px;">
                <label style="font-weight: bold;">Anmerkungen:</label>
                <textarea name="anmerkungen_basis" style="margin-top: 5px;"></textarea>
            </div>
        </div>
        
        <!-- Dokumentation-Checkliste -->
        <div class="section">
            <div class="section-title">Dokumentation-Checkliste</div>
            <div class="checkbox-group" style="flex-direction: column; gap: 8px;">
                <label><input type="checkbox" name="fotos"> gen√ºgend Fotos erstellt</label>
                <label><input type="checkbox" name="video"> ein Rundgang Video erstellt</label>
                <label><input type="checkbox" name="nachmessen"> unklare Ma√üeinheiten nachgemessen</label>
                <label><input type="checkbox" name="sanitaer_eingezeichnet"> Sanit√§r und K√ºchenanschl√ºsse eingezeichnet</label>
            </div>
        </div>
        
        <!-- Sektion 4: Erweiterter Block -->
        <div class="section">
            <div class="section-title">4) Erweiterter Block: Geb√§ude & Gemeinschaft</div>
            <div class="form-row">
                <label>Heizung (Art, Alter):</label>
                <input type="text" name="heizung">
            </div>
            <div class="form-row">
                <label>Dach/Fassade Zustand:</label>
                <input type="text" name="dach_fassade">
            </div>
            <div class="form-row">
                <label>Au√üenanlagen Zustand:</label>
                <input type="text" name="aussenanlagen">
            </div>
            <div class="form-row">
                <label>H√∂he der R√ºcklagen:</label>
                <input type="text" name="ruecklagen">
            </div>
            <div style="margin-top: 15px;">
                <label style="font-weight: bold;">Anmerkungen:</label>
                <textarea name="anmerkungen_erweiterter_block" style="margin-top: 5px;"></textarea>
            </div>
        </div>
        
        <!-- Einheiten-Konfigurator -->
        <div class="control-panel no-print">
            <div class="section-title">üè† Einheiten konfigurieren</div>
            <div class="form-row">
                <label>Anzahl Einheiten:</label>
                <input type="number" id="anzahl-einheiten" min="1" max="20" value="1">
                <button class="generate-button" onclick="generateEinheiten()">Einheiten generieren</button>
            </div>
            <div style="margin-top: 10px; font-size: 11px; color: #666;">
                üí° Geben Sie die Anzahl der zu bewertenden Einheiten ein (z.B. Wohnungen bei Mehrfamilienhaus oder Etagen bei Einfamilienhaus)
            </div>
        </div>
        
        <!-- Container f√ºr dynamische Einheiten -->
        <div id="einheiten-container">
            <div class="section-title">5) Einheiten - Renovierungsbedarfs-Bewertung</div>
            <!-- Hier werden die Einheiten dynamisch eingef√ºgt -->
        </div>
        
        <!-- Zusammenfassung (wird dynamisch bef√ºllt) -->
        <div id="zusammenfassung-container"></div>
    </div>

    <script>
        // Raum-spezifische Bewertungskriterien
        const raumKriterien = {
            'badezimmer': 'Bewertungshilfe: Fliesen, Sanit√§robjekte, Armaturen, Dusche/Wanne, Heizung',
            'kueche': 'Bewertungshilfe: Anschl√ºsse, Wandzustand, Bodenfliesen, vorhandene Einbauten',
            'wohnzimmer': 'Bewertungshilfe: W√§nde, Decke, Boden, Fenster, Heizk√∂rper',
            'schlafzimmer': 'Bewertungshilfe: W√§nde, Decke, Boden, Fenster, Heizk√∂rper',
            'kinderzimmer': 'Bewertungshilfe: W√§nde, Decke, Boden, Fenster, Heizk√∂rper',
            'flur': 'Bewertungshilfe: Boden, W√§nde, Beleuchtung, Eingangst√ºr',
            'balkon': 'Bewertungshilfe: Boden, Gel√§nder, √úberdachung, Anstrich',
            'arbeitszimmer': 'Bewertungshilfe: W√§nde, Decke, Boden, Fenster, Heizk√∂rper',
            'abstellraum': 'Bewertungshilfe: W√§nde, Boden, Beleuchtung, Bel√ºftung',
            'gaeste_wc': 'Bewertungshilfe: Fliesen, Sanit√§robjekte, Armaturen, Bel√ºftung'
        };

        // Bewertungsskala mit Beschreibungen
        const bewertungsSkala = {
            '10': '10 - Perfekt renoviert, wie neu, keine Ma√ünahmen n√∂tig',
            '9': '9 - Sehr gut, h√∂chstens kleinste Sch√∂nheitskorrekturen',
            '8': '8 - Gut, eventuell kleine Versch√∂nerungen sinnvoll',
            '7': '7 - Ordentlich, kleine Auffrischungen empfehlenswert',
            '6': '6 - Durchschnittlich, mehrere kleinere Ma√ünahmen n√∂tig',
            '5': '5 - Renovierungsbed√ºrftig, gr√∂√üere Einzelma√ünahmen erforderlich',
            '4': '4 - Stark veraltet, umfangreiche Renovierung n√∂tig',
            '3': '3 - Schlecht, fast alles muss erneuert werden',
            '2': '2 - Sehr schlecht, Komplettsanierung erforderlich',
            '1': '1 - Unbewohnbar, komplette Neuerstellung aller Bereiche n√∂tig'
        };

        function generateEinheiten() {
            const anzahl = parseInt(document.getElementById('anzahl-einheiten').value);
            const container = document.getElementById('einheiten-container');
            
            // Container leeren, aber Titel behalten
            container.innerHTML = '<div class="section-title">5) Einheiten - Renovierungsbedarfs-Bewertung</div>';
            
            for (let i = 1; i <= anzahl; i++) {
                const einheitHtml = `
                    <div class="unit-block">
                        <div class="unit-title">Einheit ${i}: <input type="text" name="einheit_${i}_name" style="border-bottom: 2px solid #2c5aa0; min-width: 200px;" placeholder="z.B. EG, 1. OG, Wohnung 1A..."></div>
                        
                        <!-- Raum-Konfiguration -->
                        <div class="room-config-panel">
                            <div class="room-config-title">üè† Raum-Konfiguration</div>
                            <div class="form-row">
                                <label>Anzahl R√§ume:</label>
                                <input type="number" id="anzahl-raeume-${i}" min="1" max="15" value="3" style="width: 60px;">
                                <button class="generate-button" onclick="generateRaeume(${i})">R√§ume generieren</button>
                            </div>
                            <div class="form-row" style="margin-top: 10px;">
                                <label>Alle R√§ume setzen auf:</label>
                                <input type="number" id="alle-raeume-wert-${i}" min="1" max="10" style="width: 50px;">
                                <button class="generate-button" onclick="setzeAlleRaeume(${i})" style="background-color: #ff6b35;">Alle R√§ume setzen</button>
                            </div>
                        </div>
                        
                        <!-- Container f√ºr R√§ume -->
                        <div id="raeume-container-${i}">
                            <!-- R√§ume werden hier eingef√ºgt -->
                        </div>
                        
                        <!-- Sonstige Notizen -->
                        <div class="subsection">
                            <div class="subsection-title">Sonstige Notizen Einheit:</div>
                            <textarea name="einheit_${i}_notizen"></textarea>
                        </div>
                        
                        <!-- Gesamtkostensch√§tzung (ausgegraut) -->
                        <div class="subsection">
                            <div class="subsection-title">Gesamtkostensch√§tzung:</div>
                            <input type="text" name="einheit_${i}_gesamtkosten" class="disabled-field" placeholder="" readonly>
                            <div class="neuwo-note">Kostensch√§tzung erfolgt durch NeuWohnen</div>
                        </div>
                    </div>
                `;
                container.innerHTML += einheitHtml;
                
                // Initial 4 R√§ume generieren (Standard)
                setTimeout(() => generateRaeume(i), 100);
            }
            
            // Zusammenfassung aktualisieren
            setTimeout(updateZusammenfassung, 200);
        }

        // Definiere typische Raumkombinationen f√ºr verschiedene Wohnungsgr√∂√üen
        const typischeRaumkombinationen = {
            1: ['badezimmer'],
            2: ['badezimmer', 'schlafzimmer'],
            3: ['flur', 'badezimmer', 'wohnzimmer'],
            4: ['flur', 'badezimmer', 'wohnzimmer', 'schlafzimmer'],
            5: ['flur', 'badezimmer', 'wohnzimmer', 'schlafzimmer', 'kueche'],
            6: ['flur', 'badezimmer', 'wohnzimmer', 'schlafzimmer', 'kueche', 'kinderzimmer'],
            7: ['flur', 'badezimmer', 'wohnzimmer', 'schlafzimmer', 'kueche', 'kinderzimmer', 'arbeitszimmer'],
            8: ['flur', 'badezimmer', 'wohnzimmer', 'schlafzimmer', 'kueche', 'kinderzimmer', 'arbeitszimmer', 'gaeste_wc'],
            9: ['flur', 'badezimmer', 'wohnzimmer', 'schlafzimmer', 'kueche', 'kinderzimmer', 'arbeitszimmer', 'gaeste_wc', 'balkon'],
            10: ['flur', 'badezimmer', 'wohnzimmer', 'schlafzimmer', 'kueche', 'kinderzimmer', 'arbeitszimmer', 'gaeste_wc', 'balkon', 'abstellraum']
        };

        function generateRaeume(einheitNummer) {
            const anzahl = parseInt(document.getElementById(`anzahl-raeume-${einheitNummer}`).value);
            const container = document.getElementById(`raeume-container-${einheitNummer}`);
            
            container.innerHTML = '';
            
            // Hole die vordefinierte Raumkombination oder verwende eine Standard-Kombination
            const vorausgewaehlteRaeume = typischeRaumkombinationen[anzahl] || 
                Array(anzahl).fill('').map((_, i) => {
                    // Fallback f√ºr mehr als 10 R√§ume
                    if (i === 0) return 'flur';
                    if (i === 1) return 'badezimmer';
                    if (i === 2) return 'wohnzimmer';
                    if (i === 3) return 'schlafzimmer';
                    if (i === 4) return 'kueche';
                    return ''; // Leer lassen f√ºr zus√§tzliche R√§ume
                });
            
            for (let r = 1; r <= anzahl; r++) {
                const vorausgewaehlterRaum = vorausgewaehlteRaeume[r - 1] || '';
                const raumHtml = `
                    <div class="room-block" id="raum-${einheitNummer}-${r}">
                        <div class="room-title">
                            Raum ${r}: 
                            <select name="einheit_${einheitNummer}_raum_${r}_typ" class="room-type-select" onchange="updateRaumKriterien(${einheitNummer}, ${r})" style="width: 150px;">
                                <option value="">-- Raum-Typ w√§hlen --</option>
                                <option value="badezimmer" ${vorausgewaehlterRaum === 'badezimmer' ? 'selected' : ''}>Badezimmer</option>
                                <option value="kueche" ${vorausgewaehlterRaum === 'kueche' ? 'selected' : ''}>K√ºche</option>
                                <option value="wohnzimmer" ${vorausgewaehlterRaum === 'wohnzimmer' ? 'selected' : ''}>Wohnzimmer</option>
                                <option value="schlafzimmer" ${vorausgewaehlterRaum === 'schlafzimmer' ? 'selected' : ''}>Schlafzimmer</option>
                                <option value="kinderzimmer" ${vorausgewaehlterRaum === 'kinderzimmer' ? 'selected' : ''}>Kinderzimmer</option>
                                <option value="flur" ${vorausgewaehlterRaum === 'flur' ? 'selected' : ''}>Flur</option>
                                <option value="balkon" ${vorausgewaehlterRaum === 'balkon' ? 'selected' : ''}>Balkon</option>
                                <option value="arbeitszimmer" ${vorausgewaehlterRaum === 'arbeitszimmer' ? 'selected' : ''}>Arbeitszimmer</option>
                                <option value="abstellraum" ${vorausgewaehlterRaum === 'abstellraum' ? 'selected' : ''}>Abstellraum</option>
                                <option value="gaeste_wc" ${vorausgewaehlterRaum === 'gaeste_wc' ? 'selected' : ''}>G√§ste-WC</option>
                            </select>
                            <button class="remove-room-button no-print" onclick="removeRaum(${einheitNummer}, ${r})" style="margin-left: 10px;">‚ùå</button>
                        </div>
                        
                        <!-- Zustandsbewertung -->
                        <div class="form-row">
                            <label>Zustandsbewertung (1-10):</label>
                            <select name="einheit_${einheitNummer}_raum_${r}_bewertung" class="rating-scale-select" onchange="updateZusammenfassung()">
                                <option value="">-- Bewertung w√§hlen --</option>
                                <option value="10">${bewertungsSkala['10']}</option>
                                <option value="9">${bewertungsSkala['9']}</option>
                                <option value="8">${bewertungsSkala['8']}</option>
                                <option value="7">${bewertungsSkala['7']}</option>
                                <option value="6">${bewertungsSkala['6']}</option>
                                <option value="5">${bewertungsSkala['5']}</option>
                                <option value="4">${bewertungsSkala['4']}</option>
                                <option value="3">${bewertungsSkala['3']}</option>
                                <option value="2">${bewertungsSkala['2']}</option>
                                <option value="1">${bewertungsSkala['1']}</option>
                            </select>
                        </div>
                        
                        <!-- Spezifische Kriterien -->
                        <div id="kriterien-${einheitNummer}-${r}" class="specific-criteria" style="display: none;">
                            <div class="specific-criteria-title">Spezifische Bewertungskriterien:</div>
                            <div id="kriterien-text-${einheitNummer}-${r}"></div>
                        </div>
                        
                        <!-- Renovierungsma√ünahmen -->
                        <div style="margin-top: 10px;">
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">Konkrete Renovierungsma√ünahmen:</label>
                            <textarea name="einheit_${einheitNummer}_raum_${r}_massnahmen" placeholder="Welche konkreten Arbeiten sind in diesem Raum n√∂tig? (z.B. W√§nde streichen, neue Fliesen, Elektrik erneuern...)" style="width: 100%; min-height: 60px;"></textarea>
                        </div>
                        
                        <!-- Kostensch√§tzung (ausgegraut) -->
                        <div style="margin-top: 10px;">
                            <label style="font-weight: bold; display: block; margin-bottom: 5px;">Kostensch√§tzung:</label>
                            <input type="text" name="einheit_${einheitNummer}_raum_${r}_kosten" class="disabled-field" placeholder="" readonly style="width: 100%;">
                            <div class="neuwo-note">Kostensch√§tzung erfolgt durch NeuWohnen</div>
                        </div>
                    </div>
                `;
                container.innerHTML += raumHtml;
            }
            
            // Button zum Hinzuf√ºgen weiterer R√§ume
            const addButtonHtml = `
                <div class="no-print" style="text-align: center; margin: 10px 0;">
                    <button class="add-room-button" onclick="addRaum(${einheitNummer})">+ Weiteren Raum hinzuf√ºgen</button>
                </div>
            `;
            container.innerHTML += addButtonHtml;
            
            // Aktualisiere Kriterien f√ºr alle vorausgew√§hlten R√§ume
            for (let r = 1; r <= anzahl; r++) {
                if (vorausgewaehlteRaeume[r - 1]) {
                    updateRaumKriterien(einheitNummer, r);
                }
            }
            
            updateZusammenfassung();
        }

        function updateRaumKriterien(einheitNummer, raumNummer) {
            const raumTyp = document.querySelector(`select[name="einheit_${einheitNummer}_raum_${raumNummer}_typ"]`).value;
            const kriterienDiv = document.getElementById(`kriterien-${einheitNummer}-${raumNummer}`);
            const kriterienText = document.getElementById(`kriterien-text-${einheitNummer}-${raumNummer}`);
            
            if (raumTyp && raumKriterien[raumTyp]) {
                kriterienText.textContent = raumKriterien[raumTyp];
                kriterienDiv.style.display = 'block';
            } else {
                kriterienDiv.style.display = 'none';
            }
        }

        function setzeAlleRaeume(einheitNummer) {
            const wert = document.getElementById(`alle-raeume-wert-${einheitNummer}`).value;
            
            if (!wert || wert < 1 || wert > 10) {
                alert('Bitte geben Sie einen Wert zwischen 1 und 10 ein.');
                return;
            }
            
            // Finde alle Bewertungs-Selects f√ºr diese Einheit
            const container = document.getElementById(`raeume-container-${einheitNummer}`);
            const bewertungsSelects = container.querySelectorAll('select[class="rating-scale-select"]');
            
            // Setze alle Bewertungen auf den gew√§hlten Wert
            bewertungsSelects.forEach(select => {
                select.value = wert;
            });
            
            // Zusammenfassung aktualisieren
            updateZusammenfassung();
            
            // Best√§tigungsmeldung
            alert(`Alle ${bewertungsSelects.length} R√§ume wurden auf Bewertung ${wert} gesetzt.`);
        }

        function addRaum(einheitNummer) {
            const container = document.getElementById(`raeume-container-${einheitNummer}`);
            const aktuelleRaeume = container.querySelectorAll('.room-block').length;
            const neueRaumNummer = aktuelleRaeume + 1;
            
            // Button tempor√§r entfernen
            const addButton = container.querySelector('.no-print');
            if (addButton) addButton.remove();
            
            const raumHtml = `
                <div class="room-block" id="raum-${einheitNummer}-${neueRaumNummer}">
                    <div class="room-title">
                        Raum ${neueRaumNummer}: 
                        <select name="einheit_${einheitNummer}_raum_${neueRaumNummer}_typ" class="room-type-select" onchange="updateRaumKriterien(${einheitNummer}, ${neueRaumNummer})" style="width: 150px;">
                            <option value="">-- Raum-Typ w√§hlen --</option>
                            <option value="badezimmer">Badezimmer</option>
                            <option value="kueche">K√ºche</option>
                            <option value="wohnzimmer">Wohnzimmer</option>
                            <option value="schlafzimmer">Schlafzimmer</option>
                            <option value="kinderzimmer">Kinderzimmer</option>
                            <option value="flur">Flur</option>
                            <option value="balkon">Balkon</option>
                            <option value="arbeitszimmer">Arbeitszimmer</option>
                            <option value="abstellraum">Abstellraum</option>
                            <option value="gaeste_wc">G√§ste-WC</option>
                        </select>
                        <button class="remove-room-button no-print" onclick="removeRaum(${einheitNummer}, ${neueRaumNummer})" style="margin-left: 10px;">‚ùå</button>
                    </div>
                    
                    <div class="form-row">
                        <label>Zustandsbewertung (1-10):</label>
                        <select name="einheit_${einheitNummer}_raum_${neueRaumNummer}_bewertung" class="rating-scale-select" onchange="updateZusammenfassung()">
                            <option value="">-- Bewertung w√§hlen --</option>
                            <option value="10">${bewertungsSkala['10']}</option>
                            <option value="9">${bewertungsSkala['9']}</option>
                            <option value="8">${bewertungsSkala['8']}</option>
                            <option value="7">${bewertungsSkala['7']}</option>
                            <option value="6">${bewertungsSkala['6']}</option>
                            <option value="5">${bewertungsSkala['5']}</option>
                            <option value="4">${bewertungsSkala['4']}</option>
                            <option value="3">${bewertungsSkala['3']}</option>
                            <option value="2">${bewertungsSkala['2']}</option>
                            <option value="1">${bewertungsSkala['1']}</option>
                        </select>
                    </div>
                    
                    <div id="kriterien-${einheitNummer}-${neueRaumNummer}" class="specific-criteria" style="display: none;">
                        <div class="specific-criteria-title">Spezifische Bewertungskriterien:</div>
                        <div id="kriterien-text-${einheitNummer}-${neueRaumNummer}"></div>
                    </div>
                    
                    <div style="margin-top: 10px;">
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">Konkrete Renovierungsma√ünahmen:</label>
                        <textarea name="einheit_${einheitNummer}_raum_${neueRaumNummer}_massnahmen" placeholder="Welche konkreten Arbeiten sind in diesem Raum n√∂tig? (z.B. W√§nde streichen, neue Fliesen, Elektrik erneuern...)" style="width: 100%; min-height: 60px;"></textarea>
                    </div>
                    
                    <div style="margin-top: 10px;">
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">Kostensch√§tzung:</label>
                        <input type="text" name="einheit_${einheitNummer}_raum_${neueRaumNummer}_kosten" class="disabled-field" placeholder="" readonly style="width: 100%;">
                        <div class="neuwo-note">Kostensch√§tzung erfolgt durch NeuWohnen</div>
                    </div>
                </div>
            `;
            
            // Button wieder hinzuf√ºgen
            const addButtonHtml = `
                <div class="no-print" style="text-align: center; margin: 10px 0;">
                    <button class="add-room-button" onclick="addRaum(${einheitNummer})">+ Weiteren Raum hinzuf√ºgen</button>
                </div>
            `;
            
            container.innerHTML += raumHtml + addButtonHtml;
            
            // Anzahl R√§ume input aktualisieren
            document.getElementById(`anzahl-raeume-${einheitNummer}`).value = neueRaumNummer;
            
            updateZusammenfassung();
        }

        function removeRaum(einheitNummer, raumNummer) {
            const raumElement = document.getElementById(`raum-${einheitNummer}-${raumNummer}`);
            if (raumElement) {
                raumElement.remove();
                updateZusammenfassung();
            }
        }

        function updateZusammenfassung() {
            const container = document.getElementById('zusammenfassung-container');
            let zusammenfassungHtml = `
                <div class="summary-section">
                    <div class="summary-title">üìä Zusammenfassung Renovierungsbedarfs-Bewertung</div>
            `;
            
            const einheiten = document.querySelectorAll('.unit-block');
            let gesamtPunkte = 0;
            let gesamtGewichtung = 0;
            let anzahlEinheiten = 0;
            
            einheiten.forEach((einheit, index) => {
                const einheitNummer = index + 1;
                const einheitName = einheit.querySelector(`input[name="einheit_${einheitNummer}_name"]`)?.value || `Einheit ${einheitNummer}`;
                
                let einheitPunkte = 0;
                let einheitGewichtung = 0;
                let hatBewertungen = false;
                
                zusammenfassungHtml += `<div style="margin-bottom: 15px;">`;
                zusammenfassungHtml += `<div style="font-weight: bold; color: #2c5aa0; font-size: 14px; margin-bottom: 8px;">${einheitName}:</div>`;
                
                const raeume = einheit.querySelectorAll('.room-block');
                raeume.forEach((raum, raumIndex) => {
                    const raumNummer = raumIndex + 1;
                    const raumTypSelect = raum.querySelector(`select[name="einheit_${einheitNummer}_raum_${raumNummer}_typ"]`);
                    const bewertungSelect = raum.querySelector(`select[name="einheit_${einheitNummer}_raum_${raumNummer}_bewertung"]`);
                    
                    if (raumTypSelect && bewertungSelect) {
                        const raumTyp = raumTypSelect.value;
                        const bewertung = bewertungSelect.value;
                        
                        if (raumTyp && bewertung) {
                            const gewichtung = raumTyp === 'badezimmer' ? 2 : 1;
                            const gewichtungsText = raumTyp === 'badezimmer' ? ' [2x]' : '';
                            
                            zusammenfassungHtml += `<div style="margin-left: 10px; font-size: 12px;">`;
                            zusammenfassungHtml += `- Raum ${raumNummer} (${raumTyp}): ${bewertung} Punkte${gewichtungsText}</div>`;
                            
                            // F√ºr Durchschnittsberechnung
                            const punkte = parseInt(bewertung);
                            einheitPunkte += punkte * gewichtung;
                            einheitGewichtung += gewichtung;
                            hatBewertungen = true;
                        }
                    }
                });
                
                // Durchschnitt pro Einheit
                if (hatBewertungen && einheitGewichtung > 0) {
                    const durchschnitt = (einheitPunkte / einheitGewichtung).toFixed(1);
                    zusammenfassungHtml += `<div style="margin-left: 10px; font-weight: bold; color: #2c5aa0; margin-top: 5px;">Durchschnitt ${einheitName}: ${durchschnitt} Punkte</div>`;
                    
                    // F√ºr Gesamtdurchschnitt
                    gesamtPunkte += einheitPunkte;
                    gesamtGewichtung += einheitGewichtung;
                    anzahlEinheiten++;
                }
                
                zusammenfassungHtml += `</div>`;
            });
            
            // Gesamtdurchschnitt
            if (gesamtGewichtung > 0) {
                const gesamtDurchschnitt = (gesamtPunkte / gesamtGewichtung).toFixed(1);
                zusammenfassungHtml += `
                    <div style="background: #f0f8ff; border: 2px solid #2c5aa0; padding: 12px; border-radius: 5px; margin: 15px 0;">
                        <div style="font-weight: bold; color: #2c5aa0; font-size: 16px;">
                            üèÜ GESAMTDURCHSCHNITT: ${gesamtDurchschnitt} Punkte
                        </div>
                        <div style="font-size: 11px; color: #666; margin-top: 5px;">
                            Berechnung: ${gesamtPunkte} Punkte √∑ ${gesamtGewichtung} Gewichtung | Badezimmer z√§hlen doppelt
                        </div>
                    </div>
                `;
            }
            
            // Gesamtkostensch√§tzung
            zusammenfassungHtml += `
                <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid #2c5aa0;">
                    <div style="font-weight: bold; margin-bottom: 10px;">Gesamtprojekt-Kostensch√§tzung:</div>
                    <input type="text" name="gesamtprojekt_kosten" style="width: 100%; border: none; border-bottom: 1px solid #333; background: transparent; margin-bottom: 5px;" placeholder="">
                </div>
            `;
            
            zusammenfassungHtml += `</div>`;
            
            container.innerHTML = zusammenfassungHtml;
        }
        
        // Initial eine Einheit generieren
        generateEinheiten();
    </script>
</body>
</html>